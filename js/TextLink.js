 var TextLink=function(dict,boxs,style,ignore,multi){this.Dict=dict;this.Boxs=boxs;this.Style=style?style:'<a target="_blank" title="{$link}" href="{$link}">$1</a>';this.Tags=['b','p','strong','td','div','span','h1','h2','h3','h4','h5','h6','blockquote','center','body','code','dd','dt','dl','ul','ol','li','em','font','form','i','label','fieldset','marquee','pre','table','tbody','tfoot','thead','title'];this.Multi=typeof multi!='undefined'?multi:true;this.Longs=this.Dict.length;this.Count=0; this.InArray=function(array,value){var l=array.length;for(var i=0;i<=l;i++){if(array[i]==value)return i;};return-1;} ;this.Replace=function(text){for(var i=0;i<this.Longs;i++){var key=this.Dict[i][0];var link=this.Dict[i][1].replace('{$key}',key).replace('{%key}',encodeURIComponent(key));var r=new RegExp("("+key+")",this.Multi?"ig":"i");if(r.test(text)){var str=this.Style.replace(/\{\%key\}/gm,encodeURIComponent(key)).replace(/\{\$key\}/gm,key).replace(/\{\$link\}/gm,link).replace(/\{\%link\}/gm,encodeURIComponent(link));text=text.replace(r,str);this.Count++;if(!this.Multi&&this.Longs>0){this.Dict.splice(i,1);this.Longs--;}}};return text;} ;this.Node=function(node){switch(node.nodeType){case 1:var e=node.childNodes;for(var n=0;n<e.length&&this.Longs;n++){if(e[n].nodeType==1){var tag=e[n].tagName.toLowerCase();if(ignore.length&&this.InArray(ignore,tag)>-1){continue;}};this.Node(e[n]);};break;case 3:var s=node.nodeValue;if(s){var newNode=document.createElement("span");newNode.innerHTML=this.Replace(s);this.Child(node,newNode);};break;}};this.Child=function(o,n){o.parentNode.replaceChild(n,o);} ;this.Init=function(){var s=null;var e=null;for(var j=0;j<this.Boxs.length&&this.Longs;j++){if(!this.Boxs[j])break;e=this.Boxs[j].childNodes;for(var n=0;n<e.length&&this.Longs;n++){if(!e[n])break;if(e[n].nodeType==1){var tag=e[n].tagName.toLowerCase();if(ignore.length&&this.InArray(ignore,tag)>-1){continue;}};this.Node(e[n]);}};return this.Count;};return this.Init();}
